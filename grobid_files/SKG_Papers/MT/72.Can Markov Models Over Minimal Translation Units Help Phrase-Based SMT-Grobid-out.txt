title
Can Markov Models Over Minimal Translation Units Help Phrase-Based SMT?

abstract
The phrase-based and N-gram-based SMT frameworks complement each other. While the former is better able to memorize, the latter provides a more principled model that captures dependencies across phrasal boundaries. Some work has been done to combine insights from these two frameworks. A recent successful attempt showed the advantage of using phrasebased search on top of an N-gram-based model. We probe this question in the reverse direction by investigating whether integrating N-gram-based translation and reordering models into a phrase-based decoder helps overcome the problematic phrasal independence assumption. A large scale evaluation over 8 language pairs shows that performance does significantly improve.

Introduction Phrase-based models  (Koehn et al., 2003; Och and Ney, 2004)  learn local dependencies such as reorderings, idiomatic collocations, deletions and insertions by memorization. A fundamental drawback is that phrases are translated and reordered independently of each other and contextual information outside of phrasal boundaries is ignored. The monolingual language model somewhat reduces this problem. However i) often the language model cannot overcome the dispreference of the translation model for nonlocal dependencies, ii) source-side contextual dependencies are still ignored and iii) generation of lexical translations and reordering is separated. The N-gram-based SMT framework addresses these problems by learning Markov chains over se-quences of minimal translation units (MTUs) also known as tuples  or over operations coupling lexical generation and reordering  (Durrani et al., 2011) . Because the models condition the MTU probabilities on the previous MTUs, they capture non-local dependencies and both source and target contextual information across phrasal boundaries. In this paper we study the effect of integrating tuple-based N-gram models (TSM) and operationbased N-gram models (OSM) into the phrasebased model in Moses, a state-of-the-art phrasebased system. Rather than using POS-based rewrite rules  to form a search graph, we use the ability of the phrasebased system to memorize larger translation units to replicate the effect of source linearization as done in the TSM model. We also show that using phrase-based search with MTU N-gram translation models helps to address some of the search problems that are nontrivial to handle when decoding with minimal translation units. An important limitation of the OSM N-gram model is that it does not handle unaligned or discontinuous target MTUs and requires post-processing of the alignment to remove these. Using phrases during search enabled us to make novel changes to the OSM generative story (also applicable to the TSM model) to handle unaligned target words and to use target linearization to deal with discontinuous target MTUs. We performed an extensive evaluation, carrying out translation experiments from French, Spanish, Czech and Russian to English and in the opposite direction. Our integration of the OSM model into Moses and our modification of the OSM model to deal with unaligned and discontinuous target tokens consistently improves BLEU scores over the baseline system, and shows statistically significant improvements in seven out of eight cases. 

 Previous Work Several researchers have tried to combine the ideas of phrase-based and N-gram-based SMT.  Costajuss? et al. (2007)  proposed a method for combining the two approaches by applying sentence level reranking.  Feng et al. (2010)  added a linearized source-side language model in a phrase-based system. Crego and Yvon (2010) modified the phrasebased lexical reordering model of  Tillman (2004)  for an N-gram-based system.  Niehues et al. (2011)  integrated a bilingual language model based on surface word forms and POS tags into a phrasebased system.  Zhang et al. (2013)  explored multiple decomposition structures for generating MTUs in the task of lexical selection, and to rerank the N-best candidate translations in the output of a phrase-based. A drawback of the TSM model is the assumption that source and target information is generated monotonically. The process of reordering is disconnected from lexical generation which restricts the search to a small set of precomputed reorderings.  Durrani et al. (2011)  addressed this problem by coupling lexical generation and reordering information into a single generative process and enriching the N-gram models to learn lexical reordering triggers.  Durrani et al. (2013)  showed that using larger phrasal units during decoding is superior to MTU-based decoding in an N-gram-based system. However, they do not use phrase-based models in their work, relying only on the OSM model. This paper combines insights from these recent pieces of work and show that phrase-based search combined with N-gram-based and phrase-based models in decoding is the overall best way to go. We integrate the two N-grambased models, TSM and OSM, into phrase-based Moses and show that the translation quality is improved by taking both translation and reordering context into account. Other approaches that explored such models in syntax-based systems used MTUs for sentence level reranking  (Khalilov and Fonollosa, 2009) , in dependency translation models  (Quirk and Menezes, 2006)  and in target language syntax systems  (Vaswani et al., 2011) . 

 Integration of N-gram Models We now describe our integration of TSM and OSM N-gram models into the phrase-based sys- Step-wise Generation tem. Given a bilingual sentence pair (F, E) and its alignment (A), we first identify minimal translation units (MTUs) from it. An MTU is defined as a translation rule that cannot be broken down any further. The MTUs extracted from Figure  1 (a) are A ? a, B ? b, C . . . H ? c 1 and D ? d. These units are then generated left-to-right in two different ways, as we will describe next. 

 Tuple Sequence Model (TSM) The TSM translation model assumes that MTUs are generated monotonically. To achieve this effect, we enumerate the MTUs in the target leftto-right order. This process is also called source linearization or tuple unfolding. The resulting sequence of monotonic MTUs is shown in Figure  1(b) . We then define a TSM model over this sequence (t 1 , t 2 , . . . , t J ) as: p tsm (F, E, A) = J j=1 p(t j |t j?n+1 , ..., t j?1 ) where n indicates the amount of context used. A 4-gram Kneser-Ney smoothed language model is trained with SRILM  (Stolcke, 2002) . Search: In previous work, the search graph in TSM N-gram SMT was not built dynamically like in the phrase-based system, but instead constructed as a preprocessing step using POS-based rewrite rules (learned when linearizing the source side). We do not adopt this framework. We use phrase-based search which builds up the decoding graph dynamically and searches through all possible reorderings within a fixed window. During decoding we use the phrase-internal alignments to perform source linearization. For example, if during decoding we would like to apply the phrase pair "C D H -d c", a combination of t 3 and t 4 in Figure  1 (b), then we extract the MTUs from this phrase-pair and linearize the source to be in the order of the target. We then compute the TSM probability given the n ? 1 previous MTUs (including MTUs occurring in the previous source phrases). The idea is to replicate rewrite rules with phrase-pairs to linearize the source. Previous work on N-gram-based models restricted the length of the rewrite rules to be 7 or less POS tags. We use phrases of length 6 and less. 

 Operation Sequence Model (OSM) The OSM model represents a bilingual sentence pair and its alignment through a sequence of operations that generate the aligned sentence pair. An operation either generates source and target words or it performs reordering by inserting gaps and jumping forward and backward. The MTUs are generated in the target left-to-right order just as in the TSM model. However rather than linearizing the source-side, reordering operations (gaps and jumps) are used to handle crossing alignments. During training, each bilingual sentence pair is deterministically converted to a unique sequence of operations.  2  The example in Figure  1  We learn a Markov model over a sequence of operations (o 1 , o 2 , . . . , o J ) that encapsulate MTUs and reordering information which is defined as follows: p osm (F, E, A) = J j=1 p(o j |o j?n+1 , ..., o j?1 ) A 9-gram Kneser-Ney smoothed language model is trained with SRILM.  3  By coupling reordering with lexical generation, each (translation or reordering) decision conditions on n ? 1 previous (translation and reordering) decisions spanning across phrasal boundaries. The reordering decisions therefore influence lexical selection and vice versa. A heterogeneous mixture of translation and reordering operations enables the OSM model to memorize reordering patterns and lexicalized triggers unlike the TSM model where translation and reordering are modeled separately. Search: We integrated the generative story of the OSM model into the hypothesis extension process of the phrase-based decoder. Each hypothesis maintains the position of the source word covered by the last generated MTU, the right-most source word generated so far, the number of open gaps and their relative indexes, etc. This information is required to generate the operation sequence for the MTUs in the hypothesized phrase-pair. After the operation sequence is generated, we compute its probability given the previous operations. We define the main OSM feature, and borrow 4 supportive features, the Gap, Open Gap, Gap-width and Deletion penalties  (Durrani et al., 2011) . 

 Problem: Target Discontinuity and Unaligned Words Two issues that we have ignored so far are the handling of MTUs which have discontinuous targets, and the handling of unaligned target words. Both TSM and OSM N-gram models generate MTUs linearly in left-to-right order. This assumption becomes problematic in the cases of MTUs that have target-side discontinuities (See Figure  2   The second problem is the unaligned target-side MTUs such as ? ? f in Figure  2(a) . Inserting target-side words "spuriously" during decoding is a non-trival problem because there is no evidence of when to hypothesize such words. These cases are dealt with in N-gram-based SMT by merging such MTUs to the MTU on the left or right based on attachment counts  (Durrani et al., 2011) , lexical probabilities obtained from IBM Model 1 , or POS entropy . Notice how ? ? f (Figure  2(a) ) is merged with the neighboring MTU E ? e to form a new MTU E ? ef (Figure  2 (c) ). We initially used the post-editing heuristic (PP) as defined by  Durrani et al. (2011)  for both TSM and OSM N-gram models, but found that it lowers the translation quality (See Row 2 in Table  2 ) in some language pairs. 

 Solution: Insertion and Linearization To deal with these problems, we made novel modifications to the generative story of the OSM model. Rather than merging the unaligned target MTU such as ? ? f , to its right or left MTU, we generate it through a new Generate Target Only (f) operation. Orthogonal to its counterpart Generate Source Only (I) operation (as used for MTU t 7 in Figure  2  (c)), this operation is generated as soon as the MTU containing its previous target word is generated. In Figure  2 (a), ? ? f is generated immediately after MTU E ? e is generated. In a sequence of unaligned source and target MTUs, unaligned source MTUs are generated before the unaligned target MTUs. We do not modify the decoder to arbitrarily generate unaligned MTUs but hypothesize these only when they appear within an extracted phrase-pair. The constraint provided by the phrase-based search makes the Generate Target Only operation tractable. Using phrasebased search therefore helps addressing some of the problems that exist in the decoding framework of N-gram SMT. The remaining problem is the discontinuous target MTUs such as A ? g . . . a in Figure  2(a) . We handle this with target linearization similar to the TSM source linearization. We collapse the target words g and a in the MTU A ? g . . . a to occur consecutively when generating the operation sequence. The conversion algorithm that generates the operations thinks that g and a occurred adjacently. During decoding we use the phrasal alignments to linearize such MTUs within a phrasal unit. This linearization is done only to compute the OSM feature. Other features in the phrasebased system (e.g., language model) work with the target string in its original order. Notice again how memorizing larger translation units using phrases helps us reproduce such patterns. This is achieved in the tuple N-gram model by using POS-based split and rewrite rules. 

 Evaluation Corpus: We ran experiments with data made available for the translation task of the Eighth Workshop on Statistical Machine Translation. The sizes of bitext used for the estimation of translation and monolingual language models are reported in Table  1 . All data is true-cased. 

 Pair Parallel We follow the approach of  Schwenk and Koehn (2008)  and trained domain-specific language models separately and then linearly interpolated them using SRILM with weights optimized on the heldout dev-set. We concatenated the news-test sets from four years  (2008) (2009) (2010) (2011)  to obtain a large devsetin order to obtain more stable weights . For Russian-English and English-Russian language pairs, we divided the tuning-set news-test 2012 into two halves and used 

 System fr-en es-en cs-en ru-en en-fr en-es en-cs en-ru 1. Baseline   1+pp+tsm 31.94 35.25 23.85 32.97 29.98 35.06 16.30 23.96 4. 1+pp+osm 32.17 35.50 24.14 33.21 30.35 35.34 16.49 24.22 5. 1+osm* 32.13 35.65 24.23 33.91 30.54 35.49 16.62 24.25  Table  2 : Translating into and from English. Bold: Statistically Significant  (Koehn, 2004)  w.r.t Baseline the first half for tuning and second for test. We test our systems on news-test 2012. We tune with the k-best batch MIRA algorithm  (Cherry and Foster, 2012) . Moses Baseline: We trained a Moses system  (Koehn et al., 2007)  with the following settings: maximum sentence length 80, grow-diag-finaland symmetrization of GIZA++ alignments, an interpolated Kneser-Ney smoothed 5-gram language model with KenLM  (Heafield, 2011)  used at runtime, msd-bidirectional-fe lexicalized reordering, sparse lexical and domain features  (Hasler et al., 2012) , distortion limit of 6, 100-best translation options, minimum bayes-risk decoding  (Kumar and Byrne, 2004) , cube-pruning  (Huang and Chiang, 2007)  and the no-reordering-overpunctuation heuristic. Results: Table  2  shows uncased BLEU scores  (Papineni et al., 2002)  on the test set. Row 2 (+pp) shows that the post-editing of alignments to remove unaligned and discontinuous target MTUs decreases the performance in the case of ru-en, csen and en-fr. Row 3 (+pp+tsm) shows that our integration of the TSM model slightly improves the BLEU scores for en-fr, and es-en. Results drop in ru-en and en-ru. Row 4 (+pp+osm) shows that the OSM model consistently improves the BLEU scores over the Baseline systems (Row 1) giving significant improvements in half the cases. The only result that is lower than the baseline system is that of the ru-en experiment, because OSM is built with PP alignments which particularly hurt the performance for ru-en. Finally Row 5 (+osm*) shows that our modifications to the OSM model (Section 3.4) give the best result ranging from [0.24?0.65] with statistically significant improvements in seven out of eight cases. It also shows improvements over Row 4 (+pp+osm) even in some cases where the PP heuristic doesn't hurt. The largest gains are obtained in the ru-en translation task (where the PP heuristic inflicted maximum damage). 

 Conclusion and Future Work We have addressed the problem of the independence assumption in PBSMT by integrating Ngram-based models inside a phrase-based system using a log-linear framework. We try to replicate the effect of rewrite and split rules as used in the TSM model through phrasal alignments. We presented a novel extension of the OSM model to handle unaligned and discontinuous target MTUs in the OSM model. Phrase-based search helps us to address these problems that are non-trivial to handle in the decoding frameworks of the N-grambased models. We tested our extentions and modifications by evaluating against a competitive baseline system over 8 language pairs. Our integration of TSM shows small improvements in a few cases. The OSM model which takes both reordering and lexical context into consideration consistently improves the performance of the baseline system. Our modification to the OSM model produces the best results giving significant improvements in most cases. Although our modifications to the OSM model enables discontinuous MTUs, we did not fully utilize these during decoding, as Moses only uses continous phrases. The discontinuous MTUs that span beyond a phrasal length of 6 words are therefore never hypothesized. We would like to explore this further by extending the search to use discontinuous phrases  (Galley and Manning, 2010) . Figure 1 : 1 Figure 1: Example (a) Word Alignments (b) Unfolded MTU Sequence (c) Operation Sequence (d) Step-wise Generation 
