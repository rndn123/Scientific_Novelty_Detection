title
Minimum Translation Modeling with Recurrent Neural Networks
abstract
We introduce recurrent neural networkbased Minimum Translation Unit ( MTU ) models which make predictions based on an unbounded history of previous bilingual contexts .
Traditional back - off n-gram models suffer under the sparse nature of MTUs which makes estimation of highorder sequence models challenging .
We tackle the sparsity problem by modeling MTUs both as bags - of-words and as a sequence of individual source and target words .
Our best results improve the output of a phrase - based statistical machine translation system trained on WMT 2012 French - English data by up to 1.5 BLEU , and we outperform the traditional n-gram based MTU approach by up to 0.8 BLEU .
Introduction Classical phrase - based translation models rely heavily on the language model and the reordering model to capture dependencies between phrases .
Sequence models over Minimum Translation Units ( MTUs ) have been shown to complement both syntax - based ( Quirk and Menezes , 2006 ) as well as phrase - based ( Zhang et al. , 2013 ) models by explicitly modeling relationships between phrases .
MTU models have been traditionally estimated using standard back - off n-gram techniques ( Quirk and Menezes , 2006 ; Crego and Yvon , 2010 ; Zhang et al. , 2013 ) , similar to wordbased language models ( ?2 ) .
However , the estimation of higher - order n-gram models becomes increasingly difficult due to data sparsity issues associated with large n-grams , even when training on over one hundred billion words ( Heafield et al. , 2013 ) ; bilingual units are much sparser than words and are therefore even harder to estimate .
Another drawback of n-gram models is that future predictions are based on a limited amount of previous context that is often not sufficient to capture important aspects of human language ( Rastrow et al. , 2012 ) .
Recently , several feed -forward neural networkbased models have achieved impressive improvements over traditional back - off n-gram models in language modeling ( Bengio et al. , 2003 ; Schwenk et al. , 2007 ; Schwenk et al. , 2012 ; Vaswani et al. , 2013 ) , as well as translation modeling ( Allauzen et al. , 2011 ; Le et al. , 2012 ; . These models tackle the data sparsity problem by representing words in continuous space rather than as discrete units .
Similar words are grouped in the same sub-space rather than being treated as separate entities .
Neural network models can be seen as functions over continuous representations exploiting the similarity between words , thereby making the estimation of probabilities over higherorder n-grams easier .
However , feed - forward networks do not directly address the limited context issue either , since predictions are based on a fixed - size context , similar to back - off n-gram models .
We therefore focus in this paper on recurrent neural network architectures , which address the limited context issue by basing predictions on an unbounded history of previous events which allows to capture long-span dependencies .
Recurrent architectures have recently advanced the state of the art in language modeling ( Mikolov et al. , 2010 ; Mikolov et al. , 2011a ; Mikolov , 2012 ) outperforming multi-layer feedforward based networks in perplexity and word error rate for speech recognition ( Arisoy et al. , 2012 ; Sundermeyer et al. , 2013 ) .
Recent work has also shown successful applications to machine translation ( Mikolov , 2012 ; Auli et al. , 2013 ; Kalchbrenner and Blunsom , 2013 ) .
We extend this work by modeling Minimum Translation Units with recurrent neural networks .
Specifically , we introduce two recurrent neural network - based MTU models to address the is - sues regarding data sparsity and limited context sizes by leveraging continuous representations and the unbounded history of the recurrent architecture .
Our first approach frames the problem as a sequence modeling task over minimal units ( ?3 ) .
The second model improves over the first by modeling an MTU as a bag-of-words , thereby allowing us to learn representations over sub-structures of minimal units that are shared across MTUs ( ?4 ) .
Our models significantly outperform the traditional back - off n-gram based approach and we show that they act complementary to a very strong recurrent neural network - based language model based solely on target words ( ?5 ) .
2 Minimum Translation Units Banchs et al. ( 2005 ) introduced the idea of framing translation as a sequence modeling problem where a sentence pair is generated in left-to - right order as a sequence of bilingual n-grams .
Minimum Translation Units ( Quirk and Menezes , 2006 ; Zhang et al. , 2013 ) are an extension which additionally permit tuples with empty source or target sides , thereby allowing insertion or deletion phrase pairs .
The two basic requirements for MTUs are that there are no overlapping word alignment links between phrase pairs and it should not be possible to extract smaller phrase pairs without violating the word alignment constraints .
Informally , we can think of MTUs as small phrase pairs that cannot be broken down any further without violating the two requirements .
ples obtained by an algorithm similar to phraseextraction ( Koehn et al. , 2003 ) .
Figure 1 illustrates such a partitioning .
Modeling minimal units has two advantages over considering larger phrase pairs that are effectively composed of MTUs : First , minimal units result in a unique partitioning of a sentence pair .
This has the advantage that we avoid modeling spurious derivations , that is , multiple derivations generating the same sentence pair .
Second , minimal units result in smaller models with a smoother distribution than models based on composed units ( Zhang et al. , 2013 ) .
Sentence pairs can be generated in multiple orders , such as left-to - right or right - to - left , either in source or target order .
For example , the source left-to- right order of the sentence pair in Figure 1 is simply M1 , M2 , M3 , M4 , M5 , while the target left-to- right order is M3 , M4 , M5 , M1 , M2 .
We deal with inserted or deleted words similar to Zhang et al . ( 2013 ) :
The source side null token of an inserted target phrase is placed next to the last source word aligned to the closest preceding nonnull aligned target phrase ; a similar rule is applied to null tokens on the target side .
For example , in Figure 1 we place M4 straight after M3 because " the " , the aligned target phrase , is after " held " , the previous non-null aligned target phrase .
We can straightforwardly estimate an n-gram model over MTUs to estimate the probability of a sentence pair using standard back - off techniques commonly employed in language modeling .
For example , a trigram model in target left-to - right order factors the sentence pair in Figure 1 as p( M 3 ) p( M 4 | M 3 ) p( M 5 | M 3 , M 4 ) p( M 1 | M 4 , M 5 ) p( M 2 | M 5 , M 1 ) .
If we would like to model larger contexts , then we quickly run into data sparsity issues .
To illustrate this point , consider the parameter growth of an n-gram model which is driven by the vocabulary size | V | and the n-gram order n : O ( |V | n ) .
Clearly , the exact estimation of higher - order n-gram probabilities becomes more difficult with large n , leading to the estimation of events with increasingly sparse statistics , or having to rely on statistics from lower -order events with backoff models , which is less desirable .
Even wordbased language models rarely ventured so far much beyond 5 - gram statistics as demonstrated by Heafield et al . ( 2013 ) who trained a , by today 's standards , very large 5 - gram model on 130B words .
Data sparsity is therefore an even more significant issue for MTU models relying on much larger vocabularies .
In our setting , the MTU vocabulary is an order of magnitude larger than a word vocabulary obtained from the same data ( Table 1 ) .
Furthermore , most MTUs are observed only once making the reliable estimation of probabilities very challenging .
Neural network - based sequence models tackle the data sparsity problem by learning continuous word representations , that group similar words together in continuous space .
For example , the distributional representations induced by recurrent neural networks have been found to have interesting syntactic and semantic regularities ( Mikolov et al. , 2013 ) .
Furthermore , these representations can be exploited to estimate more reliable statistics over higher - order n-grams than with discrete word units .
Recurrent neural networks go beyond fixed - size contexts and allow the model to keep track of long-span dependencies that are important for future predictions .
In the next sections we will present Minimum Translation Unit models based on recurrent architectures .
Atomic MTU RNN Model
The first model we introduce is based on the recurrent neural network language model of Mikolov et al . ( 2010 ) .
We frame the problem as a traditional sequence modeling task which treats MTUs as atomic units , similar to the approach taken by the traditional back - off n-gram models .
The model is factored into an input layer , a hidden layer with recurrent connections , and an output layer ( Figure 2 ) .
The input layer encodes the MTU at time t as a 1 - of - N vector m t with all values being zero except for the entry representing the MTU .
The output layer y t represents a probability distribution over possible next MTUs ; both the input and output layers are of size | V | , the size of the MTU vocabulary .
The hidden layer state h t encodes the history of all MTUs observed in the sequence up to time step t.
The state of the hidden layer is determined by the input layer and the hidden layer configuration of the previous time step h t?1 .
The weights of the connections between the layers are summarized in a number of matrices :
U represents weights from the input layer to the hidden layer , and W represents connections from the previous hidden layer to the current hidden layer .
Matrix
V contains weights between the current hidden layer and the output layer .
The hidden and output layers are computed via a series of matrix-vector products and nonlinearities : h t = s( Um t + Wh t?1 ) y t = g( Vh t ) where s( z ) = 1 1 + exp {?z} , g( z m ) = exp {z m } k exp {z k } are sigmoid and softmax functions , respectively .
Additionally , the network is interpolated with a maximum entropy model of sparse n-gram features over input MTUs ( Mikolov et al. , 2011a ) .
The maximum entropy weights D are added to the output activations before applying the softmax function and are estimated jointly with all other parameters ( Figure 3 ) .
The model is optimized via a maximum likelihood objective function using stochastic gradient descent .
Training is based on the truncated back propagation through time algorithm , which unrolls the network and then computes error gradients over multiple time steps ( Rumelhart et al. , 1986 ) ; we use a cross entropy criterion to obtain the error vector with respect to the output activations and the desired prediction .
After training , the output layer represents posteriors p( m t+ 1 | m t t? n+ 1 , h t ) , the probability of the next MTU given the previous n input MTUs m t t?n+ 1 = m t , . . . , m t?n+ 1 and the current hidden layer configuration h t .
Na?ve computation of the probability distribution over the next MTU is very expensive for large vocabularies , such as commonly encountered for MTU models ( Table 1 ) .
A well established efficiency trick assigns each possible output to a unique class and then uses a two -step process to find the probability of an MTU , instead of computing the probability of all possible outputs ( Goodman , 2001 ; Emami and Jelinek , 2005 ; Mikolov et al. , 2011 b ) .
Under this scheme we compute the probability of an MTU by multiplying the probability of its class c i t with the probability of the depicted them for simplicity as a connection between the current input vector mt and the output layer .
requires the number of classes and MTUs to be evenly balanced , i.e. , each class contains exactly as many minimal units as there are classes .
Figure 3 illustrates how classing changes the structure of the network by adding an additional output layer for the class probabilities .
Bag-of-words MTU RNN Model
The previous model treats MTUs as atomic symbols which leads to large vocabularies requiring large parameter sets and expensive inference .
However , similar MTUs may share the same words , or words which are related in continuous space .
The atomic MTU model does not exploit this since it cannot access the internal structure of a minimal unit .
The approach we pursue next is to break MTUs into individual source and target words ( Le et al. , 2012 ) in order to exploit structural similarities between infrequently observed minimal units .
Singletons represent the vast majority of our MTU vocabulary ( Table 1 ) .
This resembles the wordhashing trick of Huang et al . ( 2013 ) who represented individual words as a bag-of- character ngrams to reduce the vocabulary size of a neural network - based model in an information retrieval setting .
2
We first describe a theoretically appealing but computationally expensive model and then discuss a more practical variation .
The input layer of this model accepts the current minimal unit as a K-of - N vector representing K source and target words as opposed to the 1 - of - N encoding of entire MTUs in the previous model ( Figure 4 ) .
Larger MTUs may contain the same word more than once and we simply adjust their count to one .
This bag-of-words encoding of minimal units dramatically reduces the vocabulary size but it inevitably maps different MTUs to the same encoding .
On our data set , we observe less than 0.2 % of minimal units that are involved in collisions , a rate that is similar to Huang et al . ( 2013 ) .
In practice collisions are unlikely to affect accuracy in our setting because MTUs that are mapped to the same encoding usually do not differ much in semantic meaning as illustrated by the following examples : erfolg haben ? succeed collides with haben erfolg ? succeed , or damit , ? to and , damit ? to ; in both examples either the auxiliary verb haben or the comma changes position , neither of which significantly changes the meaning for this particular pair of MTUs .
The structure of the bag-of- words MTU RNN models is shown in Figure 4 . Similar to the atomic MTU RNN model ( ?3 ) , the hidden layer combines the signal from the input layer and the previous hidden layer configuration .
The hidden layer activations feed into a word layer w t representing the source and target words that part of all possible MTUs ; it is of the same size as the input layer .
The word layer is connected to a convolutional output layer y t by weights summarized in the sparse matrix C .
The output layer represents all possible next minimal units , where each MTU entry is only connected to neurons in the word layer representing its source and target words .
The word and MTU layers are then computed as follows : w t = s( Vh t ) y t = g( Cw t )
However , there are a number of computational issues with this model :
First , we cannot efficiently factor the word layer w t into classes such as for the atomic MTU RNN model because we require all its activations to compute the MTU output layer y t .
This reduces the best case complexity of computing the word layer from O ( | V | ) back to linear in the number of source and target words | V |.
In practice this results in between 200 - 1000 more activations that need to be computed , depending on the word vocabulary size .
Second , turning the MTU output layer into a convolutional layer is not enough to sufficiently reduce the computational effort to compute the output activations since the number of connections between the word and MTU layers is very imbalanced .
This is because frequent words , such as function words , are part of many MTUs and therefore have a very high out- degree , e.g. , the neuron representing " the " has over 82 K outgoing edges .
On the other hand , infrequent words , have a very low out -degree .
This imbalance makes it hard to efficiently compute activations and error gradients , even on a GPU , since some neurons require substantially more work than others .
4
For these reasons we decided to design a simpler , more tractable version of this model ( Figure 5 ) .
The simplified model still represents an input MTU as a bag-of- words but minimal units are generated word - by - word , first emitting source words and then target words .
This is in contrast to the original model which predicted an MTU as a single unit .
Decomposing the next MTU into individual words dramatically reduces the size of the output layer , thereby resulting in faster computation of the outputs and making normalization 4 ) .
An MTU is input as bag-of-words and the next MTU is predicted as a sequence of both source and target words .
into probabilities easier .
Furthermore , the output layer can be factorized into classes requiring only a fraction of the neurons to be computed , a much more efficient solution compared to the original model which required calculation of the entire output layer .
The simplified model computes the probability of the next MTU m t+1 as a product of individual word probabilities : p( m
t+1 | m t t? n+ 1 , h t ) = ( 1 ) a 1 , ... , a u ?m t+1 p( c k | m t t? n+ 1 , h t ) p( a k |c k , m t t? n+ 1 , h t ) where we predict a sequence of source and target words a 1 , . . . , a u ? m t+1 with a class-structured output layer , similar to the atomic model ( ?3 ) .
Training still uses a cross entropy criterion and back propagation through time , however , error vectors are computed on a per-word basis , instead of a per-MTU basis .
Direct connections between the input and output layers are based on source and target words which is less sparse than basing direct features on entire MTUs such as for the original bag-of-words model .
Overall , the simplified model retains the bag-ofwords input representation of the original model , while permitting the efficient factorization of the word-output layer into classes .
Experiments
We evaluate the effectiveness of both the atomic MTU RNN model ( ?3 ) and the simplified bag-ofwords MTU RNN model ( ?4 ) in an n-best rescoring setting , comparing against a trigram back - off MTU model as well as the phrasal decoder 1 - best output which we denote as the baseline .
Experimental Setup Baselines .
We experiment with an in- house phrase - based system similar to Moses ( Koehn et al. , 2007 ) , scoring translations by a set of common features including maximum likelihood estimates of source given target mappings p M LE ( e|f ) and vice versa p M LE ( f |e ) , as well as lexical weighting estimates p LW ( e|f ) and p LW ( f |e ) , word and phrase - penalties , a linear distortion feature and a lexicalized reordering feature .
The baseline includes a standard modified Kneser - Ney wordbased language model trained on the target-side of the parallel corpora described below .
Log-linear weights are estimated with minimum error rate training ( MERT ; Och , 2003 ) .
The 1 - best output by the phrase - based decoder is the baseline accuracy .
As a second baseline we experiment with a trigram back - off MTU model trained on all extracted MTUs , denoted as n-gram MTU .
The trigram MTU model is estimated with the same modified Kneser - Ney framework as the target side language model .
All MTU models are trained in target left-to- right MTU order which performed well in initial experiments .
Evaluation .
We test our approach on two different data sets .
First , we train a German to English system based on the data of the WMT 2006 shared task ( Koehn and Monz , 2006 ) .
The parallel corpus includes about 35 M words of parliamentary proceedings for training , a development set and two test sets with 2000 sentences each .
Second , we experiment with a French to English system based on 102M words of training data from the WMT 2012 campaign .
The majority of the training data set is parliamentary proceedings except for about 5 m words which are newswire ; all MTU models are trained on the newswire subset since we found similar accuracy to using all data in initial experiments .
We evaluate on four newswire domain test sets from 2008 , 2010 and 2011 as well as the 2010 system combination test set containing between 2034 to 3003 sentences .
Log-linear weights are estimated on the 2009 data set com-prising 2525 sentences .
We evaluate all systems in a single reference BLEU setting .
Rescoring Setup .
We rescore the 1000 - best output of the baseline phrase - based decoder by either the trigram back - off MTU model or the RNN models .
The baseline accuracy is obtained by choosing the 1 - best decoder output .
We reestimate the log-linear weights for rescoring by running a further iteration of MERT with the additional feature values ; we initialize the rescoring feature weight to zero and try 20 random restarts .
At test time we use the new set of log-linear weights to rescore the test set n-best list .
Neural Network Setup .
We trained the recurrent neural network models on between 88 % and 93 % of each data set and used the remainder as validation data .
The vocabulary of the atomic MTU RNN model is comprised of all MTU types which were observed more than once in the training data .
5 Similarly , we modeled all non-singleton words for the bag-of- words MTU RNN model .
We obtain classes for words or MTUs using a version of Brown - Clustering with an additional regularization term to optimize the runtime of the language model ( Brown et al. , 1992 ; Zweig and Makarychev , 2013 ) .
Direct connections use features over unigrams , bigrams and trigrams of words or MTUs , depending on the model .
Features are hashed to a table with at most 500 million values following Mikolov et al . ( 2011a ) .
We use the standard settings for the model with the default learning rate ? = 0.1 that decays exponentially if the validation set entropy does not decrease .
Back propagation through time computes error gradients over the past twenty time steps .
Training is stopped after 20 epochs or when the validation entropy does not decrease over two epochs .
Throughout , we use a hidden layer size of 100 which provided a good trade - off between time and accuracy in initial experiments .
Results
We first report the decoder 1 - best output as the first baseline and then rescore our two data sets ( Table 2 and Table 3
The next question we answer is if breaking MTUs into individual units to leverage similarities in the internal structure can help accuracy .
The results ( Table 2 and Table 3 ) for the bag-of-words model ( BoW MTU RNN ) clearly show that this is the case for both language pairs .
We significantly improve over the n-gram MTU model as well as the atomic RNN model on all test sets .
We observe gains of up to 0.5 BLEU over the n-gram MTU model for German to English as well as French to English ; improvements over the decoder baseline are up to 1.2 BLEU for French to English .
How do our models compare to other neural network approaches that rely only on target side information ?
To answer this question we compare to the strong language model of Mikolov ( 2012 ; RNNLM ) which has recently improved the stateof - the - art in language modeling perplexity .
The results ( Table 2 and Table 3 ) show that RNNLM performs competitively .
However , our approaches model translation since we use both source and target information as opposed to scoring only the fluency of the target side , such as done by RNNLM .
Can our models act complementary to a strong RNN language model ?
Our
Related Work
Our approach of modeling Minimum Translation Units is very much in line with recent work on ngram-based translation models ( Crego and Yvon , 2010 ) , and more recently , continuous space - based translation models ( Le et al. , 2012 ) .
The models presented in this paper differ in a number of key aspects :
We use a recurrent architecture representing an unbounded history of MTUs rather than a feed-forward style network .
Feed- forward networks as well as back - off n-gram models rely on a finite history which results in predictions independent of anything but a short context of words .
A recent side- by-side comparison between recurrent and feed-forward style neural networks ( Sundermeyer et al. , 2013 ) has shown that recurrent architectures outperform feed -forward networks in a language modeling task , a similar problem to modeling sequences over Minimum Translation Units .
Furthermore , the input of our best model is a bag-of-words representation of an MTU , unlike the ordered source and target word n-grams used by Crego and Yvon ( 2010 ) as well as Le et al . ( 2012 ) .
Finally , we model both source and target words in a single recurrent neural network .
The approach of Le et al . ( 2012 ) factorizes the joint probability over an MTU sequence in a way that suggests the use of separate neural network models for the source and the target sides , where each model generates words on the respective side only .
Other work on applying recurrent neural networks to machine translation ( Mikolov , 2012 ; Auli et al. , 2013 ; Kalchbrenner and Blunsom , 2013 ) concentrated on word - based language and translation models , whereas we model Minimum Translation Units .
Conclusion and Future Work Minimum Translation
Unit models based on recurrent neural networks lead to substantial gains over their classical n-gram back - off models .
We introduced two models of which the best improves accuracy by up to 1.5 BLEU over the 1 - best decoder output , and by 0.8 BLEU over a trigram MTU model in an n-best rescoring setting .
Our experiments have shown that representing MTUs as bags - of-words leads to better accuracy since this exploits similarities in the internal structure of Minimum Translation Units , which is not possible when modeling them as atomic symbols .
We have also shown that our models are complementary to a very strong RNN language model ( Mikolov , 2012 ) .
In future work , we would like to make the initial version of the bag-of-words model computationally more tractable using a better GPU implementation .
This model combines the efficient bag-ofwords input representation with the ability to predict MTUs as single units while explicitly modeling the constituent words in an intermediate layer .
